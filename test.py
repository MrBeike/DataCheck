#!/usr/bin/python
# -*-coding:utf-8-*-
from pywin32_system32 import *
import win32ui
import xlwings as xw
import win32con


def openfile():
    # 1表示打开文件对话框
    dlg = win32ui.CreateFileDialog(1)
    # 设置打开文件对话框中的初始显示目录
    dlg.SetOFNInitialDir('C:/')
    flag = dlg.DoModal()
    filename = dlg.GetPathName()
    # 获取选择的文件名称(已选择文件前提下)
    if flag == 1:
        return filename
    else:
        return openfile()


def readfile(filename):
    global datalist
    datalist = {}
    file = open(filename)
    for line in file:
        content = line.strip().split("|")
        datalist[content[1]] = eval(content[2])
    return datalist


def workbook(filename, datalist):
    # 打开Excel程序，默认设置：程序可见，只打开不新建工作薄，屏幕更新关闭
    app = xw.App(visible=False, add_book=False)
    app.display_alerts = False
    app.screen_updating = False
    workbook = app.books.open(filename)
    sheet = workbook.sheets[0]
    for row in range(1, 80):
        for column in range(1, 10):
            cell = sheet.range((row, column))
            if cell.value:
                if type(cell.value) == int or type(cell.value) == float:
                    celldata = str(int(cell.value)).strip()
                else:
                    celldata = str(cell.value).strip()
                if celldata in datalist:
                    cell.offset(1, 0).value = datalist[celldata]
    workbook.save()
    app.quit()
    return


datalist = {'34R01': 877, '34R03': 877, '34R04': 72, '34R07': 72, '34R10': 805, '34R15': 805, '34R16': 805,
            '34R18': 877,
            '34R20': 877, '34R21': 72, '34R22': 72, '34R28': 805, '34R29': 805, '34R30': 805, '12M01': 2278103,
            '12M02': 4007, '12M03': 60047, '12M04': 60188, '12M0A': 78398, '12M0B': 78398, '12M11': 128, '12M12': 128,
            '12M13': 128, '12M2P': 1415004, '12M2U': 1415004, '12M31': 480262, '12M32': 316165, '12M33': 1686,
            '12M35': 1686, '12M36': 101135, '12M37': 93305, '12M3A': 7830, '12M3E': 7830, '12M3H': 213344,
            '12M51': 164097,
            '12M52': 107078, '12M53': 62464, '12M54': 61526, '12M55': 198, '12M56': 642, '12M57': 98, '12M5A': 44614,
            '12M5C': 54028, '12M5D': 2991, '12M81': 8550, '12M8A': 8550, '12M8F': 1000, '12M8G': 1000, '12M95': 7550,
            '12M96': 7550, '12M9U': 16831, '12M9V': 16831, '12MB1': 5007, '12MB2': 5007, '12MB3': 3595, '12MB4': 3595,
            '12MB5': 350, '12MB7': 1412, '12MC6': 13623, '12MC7': 7895, '12MC8': 12354, '12MC9': 4459, '12MCB': 5602,
            '12MCE': 126, '12MCH': 58998, '12MDH': 58998, '12MDI': 34000, '12MDJ': 19998, '12MDM': 19998, '12MDV': 5000,
            '12MEQ': 3660, '12MF1': 3660, '12MF2': 3660, '12MF3': 3660, '12MFJ': 4837, '12MFP': 4837, '12MFS': 4065,
            '12MFX': 772, '12MFZ': 77336, '12MZQ': 111462, '12MZR': 111462, '12MZS': 111462, '12MG1': 2278103,
            '12MG2': 696451, '12MG3': 99217, '12MG4': 67240, '12MG5': 67240, '12MGB': 13501, '12MGC': 13501,
            '12MH4': 14610,
            '12MH5': 14610, '12MHB': 3866, '12MHC': 3866, '12MI1': 576080, '12MI2': 90609, '12MI4': 481755,
            '12MI6': 3716,
            '12MIK': 20449, '12MIM': 20449, '12MIQ': 4582, '12MIR': 15867, '12MIV': 705, '12MIW': 705, '12MK1': 9000,
            '12MJ6': 9000, '12MKA': 11483, '12MKB': 11483, '12MKF': 11483, '12MNK': 1404706, '12MNR': 1404706,
            '12MNU': 24100, '12MP2': 24100, '12MP7': 24100, '12MP8': 24100, '12MR1': 19149, '12MR2': 18959,
            '12MR3': 229,
            '12MR5': 416, '12MR7': 17070, '12MRB': 1244, '12MRC': 190, '12MRD': 190, '12MT1': 4087, '12MTA': 4087,
            '12MTB': 4065, '12MTG': 22, '12MTQ': 28763, '12N06': 28763, '12MTR': 28561, '12MU1': 66043, '12MU2': 27341,
            '12MU3': 4984, '12MU4': 5610, '12MU6': 2725, '12MU7': 1580, '12MU8': 23, '12MUA': 23826, '12MUC': 14321,
            '12MUE': 14321, '12MW5': 12321, '12MW6': 2000, '12MUQ': 610, '12MUW': 3256, '12MUX': 810, '12MVR': 54281,
            '12MVS': 285062, '12MVT': 5034, '12MUP': 11.0, '12A32': 59726, '12A33': 2432, '12A34': 2432, '12A37': 632,
            '12A38': 632, '12A44': 61526, '12A45': 52, '12A46': 2432, '12A47': 2432, '12A48': 3475, '12A49': 434613,
            '12A09': 8038, '12A12': 8038, '12A13': 8038, '12A18': 90454, '12A22': 90454, '12A23': 28928, '12A24': 61526,
            '12A25': 61526, '12A26': 61526, '34T01': 87185, '34T02': 1866, '34T04': 1866, '34T05': 24408,
            '34T06': 21768,
            '34T07': 2640, '34T08': 60911, '34T09': 60911, '34T14': 70760, '34T15': 40525, '34T16': 9650,
            '34T17': 30875,
            '34T18': 30235, '34T19': 30235, '34T26': 83435, '34T27': 1121, '34T29': 1121, '34T30': 22973,
            '34T31': 19683,
            '34T32': 3290, '34T33': 59341, '34T34': 59341, '34T39': 43023, '34T40': 16311, '34T41': 6970, '34T42': 9341,
            '34T43': 26712, '34T44': 25499, '34T45': 1213, '34q01': 810, '34q02': 810, '34q45': 410, '34q48': 410,
            '34q66': 400, '34q72': 400, '12D26': 480262, '12D27': 12180, '12D28': 30690, '12D29': 144770, '12D30': 440,
            '12D31': 11754, '12D32': 14752, '12D33': 1040, '12D34': 30400, '12D37': 8038, '12D38': 1500, '12D40': 716,
            '12D41': 11825, '12D42': 1490, '12D43': 180, '12D44': 588, '12D48': 209899, '12DF1': 706190,
            '12DF2': 707190,
            '12DF3': 497093, '12DF4': 493791, '12R01': 1030.0, '12R02': 519.0, '12R03': 72.0, '12R04': 66.0,
            '12R05': 204.0,
            '12R06': 133.0, '12R07': 36.0, '33001': 10147, '33002': 8032, '33015': 29, '33019': 2077, '33025': 9,
            '33026': 8564, '33027': 2693, '33041': 71, '33042': 5800, '33044': 1583, '33046': 3, '33047': 1580,
            '33048': 23,
            '33049': 1557, '33060': 352, '12P01': 415554, '12P02': 18074, '12P04': 147490, '12P05': 7144,
            '12P06': 43912,
            '12P07': 268064, '12P08': 266394, '12P09': 10930, '12P0H': 39209, '12P0J': 12260, '12P0K': 12620,
            '12P0M': 2195,
            '12P0N': 225, '12P0P': 11909, '12P0A': 1670, '12P0Q': 1670, '12P0W': 1670, '12P1E': 6353, '12P1F': 262214,
            '34S02': 8082, '34S03': 6975, '34S04': 1107, '34S05': 145069, '34S06': 16682, '34S07': 128387,
            '34S08': 104017,
            '34S09': 96487, '34S0A': 7530, '34R50': 1235, '34R1P': 1235, '34R2T': -1235, '34R2V': 1235, '33395': 5850,
            '33398': 1600, '33400': 1950, '33401': 2300, '33420': 207416, '33421': 11380, '33422': 29985,
            '33423': 108583,
            '33425': 9624, '33426': 8850, '33427': 365, '33429': 20650, '33432': 3350, '33434': 1500, '33437': 716,
            '33439': 11825, '33442': 588, '33445': 12528, '33446': 1420, '33447': 600, '33448': 8800, '33450': 475,
            '33451': 240, '33452': 365, '33464': 40, '33467': 588, '33470': 55427, '33471': 800, '33472': 705,
            '33473': 34587, '33474': 440, '33475': 180, '33476': 3602, '33477': 675, '33479': 9750, '33482': 4688,
            '33495': 9688, '33496': 100, '33497': 205, '33498': 8074, '33499': 440, '33500': 180, '33501': 192,
            '33502': 150, '33504': 270, '33507': 77, '33526': 5850, '33527': 5850, '33532': 207416, '33533': 179546,
            '33534': 22505, '33535': 5365, '33538': 12528, '33539': 11658, '33540': 620, '33541': 250, '33544': 55427,
            '33545': 42341, '33546': 8846, '33547': 4240, '33550': 9688, '33551': 7413, '33552': 1575, '33553': 700,
            '33560': 5850, '33563': 5850, '33564': 207416, '33565': 710, '33566': 23559, '33567': 183147,
            '33568': 12528,
            '33569': 270, '33570': 9073, '33571': 3185, '33572': 55427, '33573': 2580, '33574': 6517, '33575': 46330,
            '33576': 9688, '33577': 410, '33578': 1697, '33579': 7581, '33586': 5850, '33589': 5850, '33592': 207416,
            '33594': 210, '33595': 207206, '33598': 12528, '33600': 210, '33620': 12318, '33623': 55427, '33626': 55427,
            '33629': 9688, '33632': 9688, '33637': 5365, '33638': 250, '33639': 4240, '33640': 700, '33645': 410,
            '33646': 410, '33649': 400, '33650': 400, '33661': 11364, '33662': 1505, '33663': 5467, '33664': 2994,
            '33665': 138, '33666': 62, '33667': 120, '33668': 58, '33669': 106447, '33670': 3000}

# filename = openfile()
# print(filename)
# 打开Excel程序，默认设置：程序可见，只打开不新建工作薄，屏幕更新关闭
# app = xw.App(visible=False, add_book=False)
# app.display_alerts = False
# app.screen_updating = False
# workbook = app.books.open(r'C:\Users\XCB\Desktop\月报2批次校验.xls')
# sheet = workbook.sheets[0]
# for row in range(1, 80):
#     for column in range(1, 10):
#         cell = sheet.range((row, column))
#         # try:
#         #     celldata = cell.value.strip()
#         #     if celldata in datalist:
#         #         cell.offset(1, 0).value = datalist[celldata]
#         # except AttributeError:
#         #     continue
#         if cell.value:
#             if type(cell.value)==int or type(cell.value)== float:
#                 celldata = str(int(cell.value)).strip()
#             else:
#                 celldata = str(cell.value).strip()
#             if celldata in datalist:
#                 cell.offset(1, 0).value = datalist[celldata]
# workbook.save()
# app.quit()

